#!/bin/bash

# A simple script to set a wallpaper with swww and apply its colors with wal.
# This version relies on applications like Waybar and your terminal reloading
# their own colors automatically after `wal` updates the color files.

# --- SCRIPT CONFIGURATION ---
# Set your preferred swww transition effect
TRANSITION_TYPE="any"
TRANSITION_DURATION=1
# --------------------------

# Check if a wallpaper path is provided
if [ -z "$1" ]; then
  echo "Usage: $0 /path/to/wallpaper"
  exit 1
fi

WALLPAPER_PATH="$1"

# 1. Set the wallpaper using swww
# This is still required as 'wal' does not set the background in Wayland.
swww img "$WALLPAPER_PATH" --transition-type $TRANSITION_TYPE --transition-duration $TRANSITION_DURATION

# 2. Run pywal to generate colors and trigger auto-updates
# The '-i' flag tells wal to use the image and perform all its default actions,
# which includes generating files and sending reload signals.
wal -i "$WALLPAPER_PATH"

# 3. (OPTIONAL BUT RECOMMENDED) Reload Hyprland for window borders
# 'wal' CANNOT change your window border colors by itself. This command
# is still needed to make Hyprland re-read its config and apply the
# new border colors from ~/.cache/wal/colors-hyprland.conf.
#
# If you DON'T want window borders to change, you can safely remove this line.
hyprctl reload

echo "Wallpaper set and colors applied."
